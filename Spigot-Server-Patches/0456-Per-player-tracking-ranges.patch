From 13fc798ed6d5169f02cff1f63871ee2013902dc1 Mon Sep 17 00:00:00 2001
From: Tom <cryptite@gmail.com>
Date: Wed, 15 Apr 2020 08:38:27 -0500
Subject: [PATCH] Per-player tracking ranges


diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
index 22ba190f2..6ccf00840 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
@@ -135,6 +135,10 @@ public class CraftPlayer extends CraftHumanEntity implements Player {
     private long lastSaveTime;
     // Paper end
 
+    // Slice
+    private int playerTrackingRange = entity.world.spigotConfig.playerTrackingRange;
+    // Slice end
+
     public CraftPlayer(CraftServer server, EntityPlayer entity) {
         super(server, entity);
 
@@ -1948,6 +1952,18 @@ public class CraftPlayer extends CraftHumanEntity implements Player {
         getHandle().resetCooldown();
     }
 
+    //Slice
+    @Override
+    public int getPlayerTrackingRange() {
+        return playerTrackingRange;
+    }
+
+    @Override
+    public void setPlayerTrackingRange(int range) {
+        this.playerTrackingRange = range;
+    }
+    //Slice end
+
     @Override
     public void remove() {
         if (this.getHandle().getClass().equals(EntityPlayer.class)) { // special case for NMS plugins inheriting
diff --git a/src/main/java/org/spigotmc/TrackingRange.java b/src/main/java/org/spigotmc/TrackingRange.java
index 4bf4d2ac6..a9d76e32b 100644
--- a/src/main/java/org/spigotmc/TrackingRange.java
+++ b/src/main/java/org/spigotmc/TrackingRange.java
@@ -7,6 +7,7 @@ import net.minecraft.server.EntityItem;
 import net.minecraft.server.EntityItemFrame;
 import net.minecraft.server.EntityPainting;
 import net.minecraft.server.EntityPlayer;
+import org.bukkit.craftbukkit.entity.CraftPlayer;
 
 public class TrackingRange
 {
@@ -24,7 +25,7 @@ public class TrackingRange
         SpigotWorldConfig config = entity.world.spigotConfig;
         if ( entity instanceof EntityPlayer )
         {
-            return config.playerTrackingRange;
+            return ((CraftPlayer) entity.getBukkitEntity()).getPlayerTrackingRange(); // Slice
         }  else if ( entity.activationType == 1 )
         {
             return config.monsterTrackingRange;
-- 
2.17.1.windows.2

